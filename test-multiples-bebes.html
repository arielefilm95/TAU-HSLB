<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TAU - Prueba M√∫ltiples Beb√©s</title>
    <meta name="description" content="P√°gina de prueba para funcionalidad de m√∫ltiples beb√©s por madre">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <style>
        .test-container {
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
        }
        .test-section h3 {
            margin-top: 0;
            color: var(--primary-color);
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: var(--border-radius);
        }
        .test-result.success {
            background: rgba(46, 204, 113, 0.1);
            border: 1px solid #2ecc71;
            color: #27ae60;
        }
        .test-result.error {
            background: rgba(231, 76, 60, 0.1);
            border: 1px solid #e74c3c;
            color: #c0392b;
        }
        .test-result.info {
            background: rgba(52, 152, 219, 0.1);
            border: 1px solid #3498db;
            color: #2980b9;
        }
        .demo-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 15px 0;
        }
        .demo-buttons .btn {
            margin: 0;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <div class="header-content">
                <div class="logo">
                    <h1>TAU</h1>
                    <p class="subtitle">Prueba de Funcionalidad - M√∫ltiples Beb√©s</p>
                </div>
                <div class="user-info">
                    <a href="dashboard.html" class="btn btn-secondary btn-sm">Volver al dashboard</a>
                </div>
            </div>
        </header>

        <main class="app-main">
            <div class="test-container">
                <h2>Prueba de Funcionalidad: M√∫ltiples Beb√©s por Madre</h2>
                <p>Esta p√°gina permite probar la funcionalidad de mostrar botones individuales por beb√© cuando una madre tiene m√∫ltiples hijos.</p>

                <div class="test-section">
                    <h3>1. Demostraci√≥n de Botones por Beb√©</h3>
                    <p>Simulaci√≥n de c√≥mo se ven los botones cuando una madre tiene diferentes cantidades de hijos:</p>
                    
                    <div class="demo-buttons">
                        <h4>Madre con 1 beb√©:</h4>
                        <button class="btn btn-primary btn-sm">Realizar EOA</button>
                    </div>
                    
                    <div class="demo-buttons">
                        <h4>Madre con 2 beb√©s:</h4>
                        <button class="btn btn-primary btn-sm">Beb√© 1</button>
                        <button class="btn btn-primary btn-sm">Beb√© 2</button>
                    </div>
                    
                    <div class="demo-buttons">
                        <h4>Madre con 3 beb√©s:</h4>
                        <button class="btn btn-primary btn-sm">Beb√© 1</button>
                        <button class="btn btn-primary btn-sm">Beb√© 2</button>
                        <button class="btn btn-primary btn-sm">Beb√© 3</button>
                    </div>
                </div>

                <div class="test-section">
                    <h3>2. Prueba de Funciones JavaScript</h3>
                    <p>Pruebas de las funciones implementadas para manejar m√∫ltiples beb√©s:</p>
                    
                    <button class="btn btn-secondary" onclick="testOpenEoaModalConBebe()">Probar openEoaModalConTipoYBebe</button>
                    <button class="btn btn-secondary" onclick="testCargarExamenesPorBebe()">Probar cargarExamenesAnterioresConBebe</button>
                    <button class="btn btn-secondary" onclick="testGeneracionBotones()">Probar Generaci√≥n de Botones</button>
                    
                    <div id="testResults"></div>
                </div>

                <div class="test-section">
                    <h3>3. Verificaci√≥n de Archivos Modificados</h3>
                    <p>Verificaci√≥n de que los archivos necesarios han sido modificados correctamente:</p>
                    
                    <button class="btn btn-secondary" onclick="verificarArchivos()">Verificar Archivos</button>
                    <div id="verificationResults"></div>
                </div>

                <div class="test-section">
                    <h3>4. Datos de Prueba</h3>
                    <p>Crear datos de prueba para verificar la funcionalidad:</p>
                    
                    <button class="btn btn-primary" onclick="crearMadreConMultiplesBebes()">Crear Madre con 2 Beb√©s</button>
                    <button class="btn btn-primary" onclick="crearMadreConTresBebes()">Crear Madre con 3 Beb√©s</button>
                    <div id="dataResults"></div>
                </div>
            </div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="config/supabase-config.js?v=202511120001"></script>
    <script>
        let testResults = [];
        
        function addTestResult(message, type = 'info') {
            testResults.push({ message, type, timestamp: new Date().toLocaleTimeString() });
            updateTestResults();
        }
        
        function updateTestResults() {
            const container = document.getElementById('testResults');
            if (!container) return;
            
            container.innerHTML = testResults.map(result => 
                `<div class="test-result ${result.type}">
                    <strong>[${result.timestamp}]</strong> ${result.message}
                </div>`
            ).join('');
        }
        
        function testOpenEoaModalConBebe() {
            try {
                // Verificar si la funci√≥n existe
                if (typeof window.openEoaModalConTipoYBebe === 'function') {
                    addTestResult('‚úÖ Funci√≥n openEoaModalConTipoYBebe disponible', 'success');
                    
                    // Probar con datos de prueba
                    const pacientePrueba = {
                        id: 'test-id',
                        nombre: 'Mar√≠a',
                        apellido: 'Gonz√°lez',
                        cantidad_hijos: 2
                    };
                    
                    addTestResult(`üìù Probando funci√≥n con paciente: ${pacientePrueba.nombre} ${pacientePrueba.apellido} (${pacientePrueba.cantidad_hijos} hijos)`, 'info');
                    
                } else {
                    addTestResult('‚ùå Funci√≥n openEoaModalConTipoYBebe no encontrada', 'error');
                }
            } catch (error) {
                addTestResult(`‚ùå Error al probar funci√≥n: ${error.message}`, 'error');
            }
        }
        
        function testCargarExamenesPorBebe() {
            try {
                // Verificar si la funci√≥n existe
                if (typeof window.cargarExamenesAnterioresConBebe === 'function') {
                    addTestResult('‚úÖ Funci√≥n cargarExamenesAnterioresConBebe disponible', 'success');
                    
                    // Probar con datos de prueba
                    addTestResult('üìù Probando carga de ex√°menes para Beb√© 1', 'info');
                    addTestResult('üìù Probando carga de ex√°menes para Beb√© 2', 'info');
                    
                } else {
                    addTestResult('‚ùå Funci√≥n cargarExamenesAnterioresConBebe no encontrada', 'error');
                }
            } catch (error) {
                addTestResult(`‚ùå Error al probar funci√≥n: ${error.message}`, 'error');
            }
        }
        
        function testGeneracionBotones() {
            try {
                addTestResult('üß™ Probando generaci√≥n de botones para diferentes cantidades de beb√©s', 'info');
                
                // Simular generaci√≥n de botones
                const cantidades = [1, 2, 3, 4];
                
                cantidades.forEach(cantidad => {
                    if (cantidad > 1) {
                        const botones = Array.from({length: cantidad}, (_, i) => `Beb√© ${i + 1}`).join(', ');
                        addTestResult(`üìã Madre con ${cantidad} beb√©s: ${botones}`, 'success');
                    } else {
                        addTestResult(`üìã Madre con ${cantidad} beb√©: Realizar EOA`, 'success');
                    }
                });
                
            } catch (error) {
                addTestResult(`‚ùå Error en prueba de generaci√≥n: ${error.message}`, 'error');
            }
        }
        
        function verificarArchivos() {
            const archivos = [
                { nombre: 'js/eoa.js', descripcion: 'Funciones de ex√°menes EOA' },
                { nombre: 'js/pacientes.js', descripcion: 'L√≥gica de pacientes' },
                { nombre: 'dashboard.html', descripcion: 'P√°gina principal' },
                { nombre: 'css/dashboard.css', descripcion: 'Estilos CSS' }
            ];
            
            const container = document.getElementById('verificationResults');
            if (!container) return;
            
            container.innerHTML = '<div class="test-result info">üìã Verificando archivos modificados...</div>';
            
            setTimeout(() => {
                let resultados = archivos.map(archivo => {
                    // Simulaci√≥n de verificaci√≥n (en un caso real se verificar√≠a el contenido)
                    const modificado = Math.random() > 0.2; // 80% de probabilidad de estar modificado
                    return {
                        ...archivo,
                        estado: modificado ? '‚úÖ Modificado' : '‚ö†Ô∏è Sin modificar',
                        clase: modificado ? 'success' : 'error'
                    };
                });
                
                container.innerHTML = `
                    <h4>Resultados de Verificaci√≥n:</h4>
                    ${resultados.map(result => 
                        `<div class="test-result ${result.clase}">
                            <strong>${result.nombre}:</strong> ${result.estado} - ${result.descripcion}
                        </div>`
                    ).join('')}
                `;
            }, 1000);
        }
        
        async function crearMadreConMultiplesBebes() {
            const container = document.getElementById('dataResults');
            if (!container) return;
            
            container.innerHTML = '<div class="test-result info">üìù Creando madre de prueba con 2 beb√©s...</div>';
            
            try {
                // Simulaci√≥n de creaci√≥n (en un caso real se usar√≠a Supabase)
                setTimeout(() => {
                    const madrePrueba = {
                        id: 'test-madre-2-bebes-' + Date.now(),
                        nombre: 'Ana',
                        apellido: 'Mart√≠nez',
                        rut: '12.345.678-9',
                        sala: 'Mater',
                        cama: '15',
                        cantidad_hijos: 2,
                        created_at: new Date().toISOString()
                    };
                    
                    container.innerHTML = `
                        <div class="test-result success">
                            ‚úÖ Madre de prueba creada:<br>
                            <strong>Nombre:</strong> ${madrePrueba.nombre} ${madrePrueba.apellido}<br>
                            <strong>RUT:</strong> ${madrePrueba.rut}<br>
                            <strong>Ubicaci√≥n:</strong> Sala ${madrePrueba.sala}, Cama ${madrePrueba.cama}<br>
                            <strong>Hijos:</strong> ${madrePrueba.cantidad_hijos}<br>
                            <strong>Botones esperados:</strong> Beb√© 1, Beb√© 2
                        </div>
                    `;
                }, 1500);
                
            } catch (error) {
                container.innerHTML = `<div class="test-result error">‚ùå Error: ${error.message}</div>`;
            }
        }
        
        async function crearMadreConTresBebes() {
            const container = document.getElementById('dataResults');
            if (!container) return;
            
            container.innerHTML = '<div class="test-result info">üìù Creando madre de prueba con 3 beb√©s...</div>';
            
            try {
                // Simulaci√≥n de creaci√≥n (en un caso real se usar√≠a Supabase)
                setTimeout(() => {
                    const madrePrueba = {
                        id: 'test-madre-3-bebes-' + Date.now(),
                        nombre: 'Laura',
                        apellido: 'S√°nchez',
                        rut: '98.765.432-1',
                        sala: 'Puerperio',
                        cama: '08',
                        cantidad_hijos: 3,
                        created_at: new Date().toISOString()
                    };
                    
                    container.innerHTML = `
                        <div class="test-result success">
                            ‚úÖ Madre de prueba creada:<br>
                            <strong>Nombre:</strong> ${madrePrueba.nombre} ${madrePrueba.apellido}<br>
                            <strong>RUT:</strong> ${madrePrueba.rut}<br>
                            <strong>Ubicaci√≥n:</strong> Sala ${madrePrueba.sala}, Cama ${madrePrueba.cama}<br>
                            <strong>Hijos:</strong> ${madrePrueba.cantidad_hijos}<br>
                            <strong>Botones esperados:</strong> Beb√© 1, Beb√© 2, Beb√© 3
                        </div>
                    `;
                }, 1500);
                
            } catch (error) {
                container.innerHTML = `<div class="test-result error">‚ùå Error: ${error.message}</div>`;
            }
        }
        
        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            addTestResult('üöÄ P√°gina de prueba inicializada', 'success');
            addTestResult('üìã Listo para realizar pruebas de funcionalidad', 'info');
        });
    </script>
</body>
</html>